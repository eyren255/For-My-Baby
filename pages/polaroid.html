<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Polaroid Wall Â· For My Baby</title>
    <link rel="icon" type="image/svg+xml" href="../favicon.svg" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Poppins:wght@300;500;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="../styles.css" />
    <link rel="manifest" href="../site.webmanifest" />
    <style>
      .board{min-height:50vh;position:relative;background:#fff8fb;border:1px dashed var(--border);border-radius:14px;padding:10px}
      .pol{position:absolute;width:160px;user-select:none;cursor:grab;background:#fff;padding:8px 8px 14px;border-radius:8px;box-shadow:0 10px 20px rgba(0,0,0,.15)}
      .pol img{width:100%;display:block;border-radius:6px}
      .pol .cap{font-size:12px;color:var(--muted);text-align:center;margin-top:6px}
      .controls{display:flex;gap:8px;margin:10px 0}
    </style>
  </head>
  <body>
    <header class="site-header">
      <div class="container row between center">
        <a class="brand" href="../index.html">For My Baby</a>
        <nav class="nav">
          <a href="./quiz.html">Love Quiz</a>
          <a href="./timeline.html">Timeline</a>
          <a href="./polaroid.html" aria-current="page">Polaroid Wall</a>
          <a href="./tictactoe.html">Ticâ€‘tacâ€‘toe</a>
        </nav>
      </div>
    </header>
    <main class="container site-grid">
      <section class="section card span-2">
        <h1 class="section-title">ðŸ“· Polaroid Wall</h1>
        <div class="controls">
          <input id="file" type="file" accept="image/*" />
          <input id="cap" class="chip" placeholder="Caption" />
          <button id="add" class="chip">Add</button>
          <button id="clear" class="chip">Clear wall</button>
        </div>
        <div id="board" class="board"></div>
      </section>
    </main>
    <footer class="site-footer"><div class="container center muted">Made with ðŸ’• Â· Â© <span id="year"></span></div></footer>
    <script>
      document.getElementById('year').textContent = new Date().getFullYear();
      const KEY='polaroids';
      let items=JSON.parse(localStorage.getItem(KEY)||'[]');
      const board=document.getElementById('board');
      function save(){ localStorage.setItem(KEY, JSON.stringify(items)); }
      function render(){
        board.innerHTML='';
        items.forEach((p,idx)=>{
          const d=document.createElement('div');d.className='pol'; d.style.left=p.x+'px'; d.style.top=p.y+'px'; d.style.transform=`rotate(${p.r}deg)`;
          d.innerHTML=`<img src="${p.src}" alt="photo"/><div class='cap'>${p.cap||''}</div>`;
          board.appendChild(d);
          drag(d,(x,y)=>{ p.x=x; p.y=y; save(); });
          d.addEventListener('dblclick',()=>{ items.splice(idx,1); save(); render(); });
        });
      }
      function drag(el,onmove){
        let sx,sy,ox,oy; el.addEventListener('pointerdown',e=>{ el.setPointerCapture(e.pointerId); sx=e.clientX; sy=e.clientY; const rect=el.getBoundingClientRect(); const b=board.getBoundingClientRect(); ox=rect.left-b.left; oy=rect.top-b.top; el.style.cursor='grabbing';});
        el.addEventListener('pointermove',e=>{ if(sx==null) return; const b=board.getBoundingClientRect(); let nx=ox+(e.clientX-sx); let ny=oy+(e.clientY-sy); nx=Math.max(0,Math.min(nx,b.width-el.offsetWidth)); ny=Math.max(0,Math.min(ny,b.height-el.offsetHeight)); el.style.left=nx+'px'; el.style.top=ny+'px'; onmove(nx,ny);});
        el.addEventListener('pointerup',()=>{ sx=sy=null; el.style.cursor='grab'; });
      }
      document.getElementById('add').addEventListener('click',()=>{
        const file=document.getElementById('file').files[0]; if(!file) return;
        const reader=new FileReader(); reader.onload=()=>{ items.push({src:reader.result,cap:document.getElementById('cap').value,x:10,y:10,r:(Math.random()*10-5).toFixed(1)}); save(); render();}; reader.readAsDataURL(file);
      });
      document.getElementById('clear').addEventListener('click',()=>{ if(confirm('Clear all photos?')){ items=[]; save(); render(); }});
      render();
      if ('serviceWorker' in navigator) { window.addEventListener('load', () => { navigator.serviceWorker.register('../sw.js').catch(()=>{}); }); }
    </script>
  </body>
  </html>


